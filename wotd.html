<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>wotd</title>
    <!-- Favicon: Speech Bubble SVG -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’¬</text></svg>">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;600&display=swap');
        
        :root {
            --bg-color: #0a0a0a;
            --card-bg: #141414;
            --text-main: #e5e7eb;
            --text-muted: #9ca3af;
            --accent-blue: #3b82f6;
            --accent-emerald: #10b981;
            --accent-purple: #a855f7;
            --border: #262626;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 4rem 1rem;
        }

        .serif { font-family: 'Libre Baskerville', serif; }
        
        .word-card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .word-card:hover {
            transform: translateY(-4px);
            border-color: #404040;
            background: #1a1a1a;
        }

        #error-message {
            display: none;
        }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-muted);
            transition: all 0.2s;
        }

        .btn-secondary:hover {
            background: #1f1f1f;
            color: white;
            border-color: #444;
        }
    </style>
</head>
<body>

    <header class="text-center mb-16">
        <h1 class="serif text-5xl font-bold mb-4 text-white tracking-tight">Words of the Day</h1>
        <p id="current-date" class="text-gray-500 uppercase tracking-[0.3em] text-xs font-bold"></p>
    </header>

    <div id="error-message" class="max-w-md mb-8 p-4 bg-red-900/20 border border-red-500/50 text-red-200 rounded-xl text-sm text-center">
        <p class="font-bold mb-1">Local File Access Restricted</p>
        <p class="opacity-80">Using internal backup lexicon. Run via a local server to use lexicon.json.</p>
    </div>

    <main class="grid grid-cols-1 md:grid-cols-3 gap-8 w-full max-w-6xl mb-16">
        <!-- Academic Word -->
        <section class="word-card p-10 rounded-3xl flex flex-col h-full shadow-2xl">
            <span class="text-[10px] font-black text-blue-400 uppercase tracking-[0.2em] mb-6">Academic</span>
            <div id="academic-container">
                <h2 id="word-academic" class="serif text-4xl font-bold mb-3 text-white">...</h2>
                <p id="pos-academic" class="italic text-blue-400/60 font-medium mb-6 text-sm">...</p>
                <p id="def-academic" class="text-gray-400 leading-relaxed text-lg">...</p>
            </div>
            <div class="mt-auto pt-8">
                <button onclick="shuffleWord('academic')" class="text-[10px] font-bold text-gray-500 hover:text-blue-400 transition-colors flex items-center gap-2 uppercase tracking-widest">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M16 3h5v5M4 20L21 3M21 16v5h-5M15 15l6 6M4 4l5 5"/></svg>
                    Shuffle
                </button>
            </div>
        </section>

        <!-- Literary Word -->
        <section class="word-card p-10 rounded-3xl flex flex-col h-full shadow-2xl">
            <span class="text-[10px] font-black text-emerald-400 uppercase tracking-[0.2em] mb-6">Literary</span>
            <div id="literary-container">
                <h2 id="word-literary" class="serif text-4xl font-bold mb-3 text-white">...</h2>
                <p id="pos-literary" class="italic text-emerald-400/60 font-medium mb-6 text-sm">...</p>
                <p id="def-literary" class="text-gray-400 leading-relaxed text-lg">...</p>
            </div>
            <div class="mt-auto pt-8">
                <button onclick="shuffleWord('literary')" class="text-[10px] font-bold text-gray-500 hover:text-emerald-400 transition-colors flex items-center gap-2 uppercase tracking-widest">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M16 3h5v5M4 20L21 3M21 16v5h-5M15 15l6 6M4 4l5 5"/></svg>
                    Shuffle
                </button>
            </div>
        </section>

        <!-- Whimsical Word -->
        <section class="word-card p-10 rounded-3xl flex flex-col h-full shadow-2xl">
            <span class="text-[10px] font-black text-purple-400 uppercase tracking-[0.2em] mb-6">Whimsical</span>
            <div id="whimsical-container">
                <h2 id="word-whimsical" class="serif text-4xl font-bold mb-3 text-white">...</h2>
                <p id="pos-whimsical" class="italic text-purple-400/60 font-medium mb-6 text-sm">...</p>
                <p id="def-whimsical" class="text-gray-400 leading-relaxed text-lg">...</p>
            </div>
            <div class="mt-auto pt-8">
                <button onclick="shuffleWord('whimsical')" class="text-[10px] font-bold text-gray-500 hover:text-purple-400 transition-colors flex items-center gap-2 uppercase tracking-widest">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M16 3h5v5M4 20L21 3M21 16v5h-5M15 15l6 6M4 4l5 5"/></svg>
                    Shuffle
                </button>
            </div>
        </section>
    </main>

    <footer class="flex flex-wrap justify-center gap-6">
        <button onclick="revertToToday()" class="btn-secondary px-8 py-3 rounded-full text-xs font-bold uppercase tracking-widest flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
            Today's Words
        </button>
        <button onclick="shuffleAll()" class="px-8 py-3 bg-white text-black rounded-full text-xs font-bold uppercase tracking-widest hover:bg-gray-200 transition-all flex items-center gap-2 shadow-xl active:scale-95">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M16 3h5v5M4 20L21 3M21 16v5h-5M15 15l6 6M4 4l5 5"/></svg>
            Shuffle All
        </button>
    </footer>

    <script>
        const DEFAULT_LEXICON = {
            "academic": [
                { "word": "Epistemology", "pos": "noun", "definition": "The branch of philosophy that examines the nature, origin, and limits of human knowledge." },
                { "word": "Paradigm", "pos": "noun", "definition": "A distinct set of concepts or thought patterns, including theories, research methods, and standards." }
            ],
            "literary": [
                { "word": "Ineluctable", "pos": "adj.", "definition": "Unable to be resisted or avoided; inescapable." },
                { "word": "Quixotic", "pos": "adj.", "definition": "Exceedingly idealistic; unrealistic and impractical." }
            ],
            "whimsical": [
                { "word": "Ballyhoo", "pos": "noun", "definition": "Extravagant publicity or fuss." },
                { "word": "Kerfuffle", "pos": "noun", "definition": "A commotion or fuss, especially one caused by conflicting views." }
            ]
        };

        let lexiconData = null;
        const categories = ['academic', 'literary', 'whimsical'];

        function getDayOfYearIndex() {
            const now = new Date();
            const start = new Date(now.getFullYear(), 0, 0);
            const diff = (now - start) + ((start.getTimezoneOffset() - now.getTimezoneOffset()) * 60 * 1000);
            const oneDay = 1000 * 60 * 60 * 24;
            const dayOfYear = Math.floor(diff / oneDay);
            return dayOfYear - 1; 
        }

        async function init() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').innerText = new Date().toLocaleDateString('en-US', options);

            try {
                const response = await fetch('lexicon.json');
                if (!response.ok) throw new Error('Not found');
                lexiconData = await response.json();
                console.log("Lexicon loaded successfully:", lexiconData);
            } catch (err) {
                console.warn("Could not load lexicon.json. Using fallback.");
                lexiconData = DEFAULT_LEXICON;
                if (window.location.protocol === 'file:') {
                    document.getElementById('error-message').style.display = 'block';
                }
            }
            revertToToday();
        }

        function displayWord(category, index) {
            if (!lexiconData || !lexiconData[category]) return;
            const list = lexiconData[category];
            const safeIndex = index % list.length;
            const item = list[safeIndex];

            // Debugging log to see what the item looks like in the console
            console.log(`Displaying ${category}:`, item);

            document.getElementById(`word-${category}`).innerText = item.word || "Unknown";
            document.getElementById(`pos-${category}`).innerText = item.pos || "";
            
            // Fix for 'undefined' issue: Check multiple possible keys
            const definition = item.definition || item.def || item.description || "Definition not found.";
            document.getElementById(`def-${category}`).innerText = definition;
        }

        function revertToToday() {
            const todayIndex = getDayOfYearIndex();
            categories.forEach(cat => displayWord(cat, todayIndex));
        }

        function shuffleWord(category) {
            if (!lexiconData || !lexiconData[category]) return;
            const randomIndex = Math.floor(Math.random() * lexiconData[category].length);
            displayWord(category, randomIndex);
        }

        function shuffleAll() {
            categories.forEach(cat => shuffleWord(cat));
        }

        window.onload = init;
    </script>
</body>
</html>
